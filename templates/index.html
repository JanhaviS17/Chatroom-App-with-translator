<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Freelancer - Start Bootstrap Theme</title>
        <!-- Favicon-->
        {% load static %}
        <link rel="icon" type="image/x-icon" href="{% static 'assets/favicon.ico' %}" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link type="text/css" href="{% static 'css/styles.css' %}" rel="stylesheet" />
        <script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>
    
        <style>
                @import url("https://fonts.googleapis.com/css?family=Nunito:300");
                * {
                box-sizing: border-box;
                font-family: inherit;
                }

                body {
                margin: 0;
                padding-bottom: 20px;
                font-family: "Nunito", sans-serif;
                color: #fefefe;
                background: #fefefe;
                }

                .wrapper {
                margin: 0 auto;
                max-width: 600px;
                box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
                }

                .section {
                padding: 1rem;
                }

                .header {
                position: relative;
                text-align: center;
                }
                .header__text {
                position: relative;
                padding: 3.5rem 0 7rem;
                }
                .header__text > h1 {
                margin: 0;
                font-size: 2.5rem;
                }
                .header > .trapezoid {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                transform: skewY(-10deg);
                transform-origin: top left;
                box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
                background: linear-gradient(rgba(17, 38, 190, 0.8), rgba(17, 38, 190, 0.8)), url("https://images.pexels.com/photos/520936/pexels-photo-520936.jpeg?w=940&h=650&auto=compress&cs=tinysrgb");
                background-position: top center;
                background-attachment: fixed;
                }

                form {
                margin: 0 auto;
                max-width: 17rem;
                overflow: auto;
                }
                form > * + * {
                margin-top: 1rem;
                }
                form > input {
                border: 0;
                border-bottom: 1px solid #1126be;
                border-radius: 0;
                width: 100%;
                height: 2rem;
                padding: 0 0 0.25rem 0;
                font-size: 1rem;
                color: #1126be;
                background: #fefefe;
                }
                form > input:focus {
                outline: none;
                }
                form > input::placeholder {
                color: #1126be;
                }
                form > select {
                margin-top: 2rem;
                border: 0;
                border-radius: 200px;
                width: 100%;
                padding: 0.85rem;
                font-size: 1rem;
                color: #1126be;
                background: #fefefe;
                }
                form > select:focus {
                outline: none;
                }
                form > button {
                margin-top: 2rem;
                border: 0;
                border-radius: 200px;
                width: 100%;
                padding: 0.85rem;
                font-size: 1rem;
                color: #fefefe;
                background: #1126be;
                }
                form > button:focus {
                outline: none;
                }
                form > p {
                margin: 0.25rem 0 0;
                text-align: center;
                color: #1126be;
                }

                .sign-up {
                display: none;
                }

                .opposite-btn1,
                .opposite-btn2 {
                cursor: pointer;
                }

        </style>
    
    </head>
    <body id="page-top" scroll="no" style="overflow: hidden">                
            <div class="wrapper my-auto">
    
                <!--  Header  -->
                <header class="section header">
                <div class="trapezoid"></div>
                
                <div class="header__text">
                    <h1>Hola!</h1>
                    <p>Join a room or Create one.</p>
                </div>
                </header>
            
                <!--  Create Room  -->
                <section class="section create-room">
                    <div class="trapezoid"></div>
                    <form method="POST" action="create_room">
                        {% csrf_token %}
                        <input type="text" onfocusout="room_check()" name="room_name" id="room_name" placeholder="New Room Name" required>        
                        <input type="password" name="pass" id="pass" placeholder="Set Room Password" required>
                        <input type="text" name="username" id="username" placeholder="Your Display Name" required>
                        <select name="lang" id="lang">
                            <option value="" disabled selected hidden>Preferred Langauge</option>
                            <option value="en">English</option>
                            <option value="hi">Hindi</option>
                            <option value="mr">Marathi</option>
                        </select>
                        <button id="submitButton" type="submit">Create room</button>
                        <p class="opposite-btn2">Already have an account?</p>
                    </form>
                </section>
                
                <!--  Sign In  -->
                <section class="section join-room">
                    <form method="POST" action="join_chat_room"> 
                        {% csrf_token %}

                        <input type="text" name="room_name" id="j_room_name" placeholder="Room Name" required>        
                        <input type="password" onfocusout="pass_check()" name="pass" id="j_pass" placeholder="Room Password" required>
                        <input type="text"  name="username" id="j_username" placeholder="Your Display Name" required>
                        <select name="lang" id="j_lang">
                            <option value="" disabled selected hidden>Preferred Langauge</option>
                            <option value="en">English</option>
                            <option value="hi">Hindi</option>
                            <option value="mr">Marathi</option>
                        </select>
                        <button id="j_submitButton" type="submit">Join Room</button>

                        <p class="opposite-btn1">No room to join? Create one!</p>
                    </form>
                </section>
            </div>



                <!-- Bootstrap core JS-->
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
                <!-- Core theme JS-->
                <script src="js/scripts.js"></script>
                <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
                <!-- * *                               SB Forms JS                               * *-->
                <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
                <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
                <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
                <script>
                    const createRoom = document.querySelector('.create-room');
                    const joinRoom = document.querySelector('.join-room');

                    createRoom.style.display = 'none';

                    // Switch btns: there are two only because I was in a hurry a didn't want to write all the javascript immediately. In a production environment, a better solution would be implemented.
                    const btn1 = document.querySelector('.opposite-btn1');
                    const btn2 = document.querySelector('.opposite-btn2');


                    // Switches to 'Create Room'
                    btn1.addEventListener('click', () => {
                    createRoom.style.display = 'block';
                    joinRoom.style.display = 'none'; 
                    });

                    // Switches to 'Join Room'
                    btn2.addEventListener('click', () => {
                    createRoom.style.display = 'none';
                    joinRoom.style.display = 'block';
                    });


                    function room_check() {
                        $.ajax({
                            type:'GET',
                            url:'/room_name_validation',
                            data:{
                                room_name:$('#j_room_name').val(),
                                csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                            },
                            success: function(data){
                            alert(data)

                            }
                            });
                    }


                    function pass_check() {
                            $.ajax({
                                type:'GET',
                                url:'/password_validation',
                                data:{
                                    room_name:$('#j_room_name').val(),
                                    password:$('#j_pass').val(),
                                    csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                                },
                                success: function(data){
                                alert(data)

                                }
                                });
                    }





                </script>
            </body>
        </html>